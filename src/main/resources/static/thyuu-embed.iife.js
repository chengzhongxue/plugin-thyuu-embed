(function(c){"use strict";function m(){document.querySelectorAll("thyuu-livephoto").forEach(t=>{const n=t.getAttribute("photo-url"),i=t.getAttribute("video-url"),e=t.getAttribute("photo-arn");var o='<thyuu-embed class="thyuu-noone icon-image">链接不存在<thyuu-embed>';n&&i&&(o=`
             <thyuu-embed 
             class="thyuu-livephoto">
             <div data-live-photo 
                 data-photo-src="${n}" 
                 data-video-src="${i}" 
                 style="aspect-ratio: ${e}"></div></thyuu-embed>
            `),t.insertAdjacentHTML("afterend",o),t.remove()})}function y(t,n){const i={bb:/https?:\/\/www\.bilibili\.com\/video\/(BV\w+)/,bb_live:/https?:\/\/live\.bilibili\.com\/(\d+)/,dy:/https?:\/\/www\.douyin\.com\/video\/(\d+)/,qq:/https?:\/\/v\.qq\.com\/x\/cover\/[^\/]+\/(\w+)\.html/,qq_page:/https?:\/\/v\.qq\.com\/x\/page\/([a-zA-Z0-9]+)\.html/,yk:/https?:\/\/v\.youku\.com\/v_show\/id_(\w+)(?:==)?\.html/};let e,o;for(const[h,l]of Object.entries(i)){const s=t==null?void 0:t.match(l);if(s){e=s[1],o=h;break}}if(!t)return'<thyuu-embed class="thyuu-noone icon-film">链接不存在<br></thyuu-embed>';if(!e)return`<thyuu-embed class="thyuu-noone icon-film">链接无法识别<br>${t}</thyuu-embed>`;let a="";switch(o){case"bb":a=`https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=${e}&as_wide=1&danmaku=0&hasMuteButton=1`;break;case"bb_live":a=`https://www.bilibili.com/blackboard/live/live-activity-player.html?cid=${e}&quality=0`;break;case"dy":a=`https://open.douyin.com/player/video?vid=${e}`;break;case"qq":case"qq_page":a=`https://v.qq.com/txp/iframe/player.html?vid=${e}`;break;case"yk":a=`https://player.youku.com/embed/${e}`;break;default:return'<div class="thyuu-no-video">不支持的视频平台</div>'}return`<thyuu-embed class="thyuu-video as-${n??""}" data-type="${o}"><iframe src="${a}" loading="lazy" scrolling="no" referrerpolicy="unsafe-url" allow="autoplay; encrypted-media" allowtransparency="true" allowfullscreen="true"></iframe><i class="loading">加载中</i></thyuu-embed>`}function u(){document.querySelectorAll("thyuu-video").forEach(t=>{const n=t.getAttribute("src"),i=t.getAttribute("size"),e=y(n,i);t.insertAdjacentHTML("afterend",e),t.remove()})}function r(){const t=navigator.userAgent||navigator.vendor||"";if(/android/i.test(t)||/webos/i.test(t)||/iphone/i.test(t)||/ipad/i.test(t)||/ipod/i.test(t)||/blackberry/i.test(t)||/windows phone/i.test(t))return!0;const i=window.innerWidth||document.documentElement.clientWidth,e=window.innerHeight||document.documentElement.clientHeight;return i<768||e<768}function p(t){const n={nn:/https?:\/\/music\.163\.com\/#\/song\?id=(\d+)/,nn_lists:/https?:\/\/music\.163\.com\/#\/playlist\?id=(\d+)/,nn_album:/https?:\/\/music\.163\.com\/#\/album\?id=(\d+)/,nn_on_app:/https?:\/\/music\.163\.com\/song\?id=(\d+)/,nn_lists_on_app:/https?:\/\/music\.163\.com\/playlist\?id=(\d+)/,nn_album_on_app:/https?:\/\/music\.163\.com\/album\?id=(\d+)/,qq:/https?:\/\/y\.qq\.com\/n\/ryqq\/songDetail\/(\w+)/};let i,e;for(const[h,l]of Object.entries(n)){const s=t==null?void 0:t.match(l);if(s){i=s[1],e=h;break}}if(!t)return'<thyuu-embed class="thyuu-noone icon-film">链接不存在<br></thyuu-embed>';if(!i)return`<thyuu-embed class="thyuu-noone icon-music">链接无法识别<br>${t}</thyuu-embed>`;let o,a;switch(e){case"nn":case"nn_on_app":o=(r()?"https://music.163.com/m/outchain/player?type=2&id=":"https://music.163.com/outchain/player?type=2&id=")+i,a=`<div style="margin:-11px;"><iframe src="${o}&height=66" loading="lazy" allowtransparency="true"></iframe></div>`;break;case"nn_lists":case"nn_album":case"nn_lists_on_app":case"nn_album_on_app":o=(r()?"https://music.163.com/m/outchain/player?type=0&id=":"https://music.163.com/outchain/player?type=0&id=")+i,a=`<div style="margin:-11px;"><iframe marginwidth="0" marginheight="0" width=330 height=450 src="${o}&height=430" loading="lazy" allowtransparency="true"></iframe></div>`;break;case"qq":o=`https://i.y.qq.com/n2/m/outchain/player/index.html?songid=${i}`,a=`<iframe src="${o}" loading="lazy" allowtransparency="true"></iframe>`;break;default:return""}return`<thyuu-embed class="thyuu-music" data-type="${e}">
            ${a}
            <i class="loading">加载中</i>
        </thyuu-embed>`}function d(){document.querySelectorAll("thyuu-music").forEach(t=>{const n=t.getAttribute("src"),i=p(n);t.insertAdjacentHTML("afterend",i),t.remove()})}document.addEventListener("DOMContentLoaded",()=>{u(),d(),m()},{once:!0}),document.addEventListener("pjax:success",()=>{u(),d(),m()}),c.getMusic=d,c.getVideo=u,c.isMobileDevice=r,c.thyuuShortcodeMusic=p,c.thyuuShortcodeVideo=y,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})(this["thyuu-embed"]=this["thyuu-embed"]||{});
